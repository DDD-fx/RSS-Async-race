(()=>{"use strict";var e={137:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(645),a=n.n(r),s=n(372),i=n(667),o=n.n(i),c=n(213),l=a()((function(e){return e[1]}));l.i(s.Z),l.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap);"]);var d=o()(c);l.push([e.id,'::-webkit-input-placeholder{font-style:italic}:-moz-placeholder{font-style:italic}::-moz-placeholder{font-style:italic}:-ms-input-placeholder{font-style:italic}.body{position:relative;height:100vh;padding:10px;line-height:1.2;background-image:url("data:image/png;base64,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");background-color:#69696b;color:#edeef1;display:flex;justify-content:space-between;flex-direction:column}.header__title{font-size:40px;text-align:center;color:#ff8450;margin:10px 0 20px}.main{position:relative;display:flex;gap:35px;flex-wrap:wrap;flex-direction:column;justify-content:space-between;align-items:center;font-family:Arial,Helvetica,sans-serif}.garage-winners{align-self:flex-start}.footer{width:100%;display:flex;align-items:center;justify-content:space-around;padding:2rem 0 0;font-size:1rem;margin-top:auto}.footer__logo-link{background:url('+d+') no-repeat;width:101px;height:37px}.rules{position:absolute;max-width:300px;font-family:"Courier Prime",monospace;font-size:14px;color:#ff8450;line-height:1.2;top:75px;right:30px;border:1px solid #000;border-radius:10px;padding:0 5px;box-shadow:0 0 10px 3px #a90fdb}.rules h3{text-align:center}@media(max-width: 740px){.rules{position:static;max-width:90%;margin-bottom:30px;align-self:center}}.hide{display:none}.btn{padding:8px;background:#a90fdb;font-size:14px;color:#fff;border:none;border-radius:10px;transition:all .3s}.btn:hover{cursor:pointer;box-shadow:0 0 10px 3px #a90fdb}.btn[disabled]{background:#919191}.btn[disabled]:hover{cursor:default;box-shadow:none}.btn+.btn{margin-left:10px}.error-wrapper{position:absolute;font-family:"Courier Prime",monospace;font-size:14px;overflow-wrap:break-word;text-align:center;top:230px;right:0;max-width:170px;display:flex;flex-direction:column;gap:10px}.error-msg{background:rgba(169,15,219,.2);color:#edeef1;border-radius:10px;padding:5px}.controls-wrapper{display:flex;gap:10px;flex-direction:column;align-self:flex-start}.choose-car-name,.update-car-name{line-height:1.4;border-radius:5px}.choose-car-name:focus,.choose-car-name:active,.update-car-name:focus,.update-car-name:active{outline:none}.choose-car-color,.update-car-color{cursor:pointer}.create-car,.update-car{position:relative;display:flex;align-items:center;gap:10px}.add-car-error,.add-update-error{position:absolute;font-family:"Courier Prime",monospace;font-size:14px;overflow-wrap:break-word;text-align:center;background:rgba(169,15,219,.2);color:#f8678e;border-radius:10px;padding:5px;text-align:center}.add-car-error{top:-32px;right:-130px}.add-update-error{top:40px;right:-130px}.race-block{display:flex;flex-direction:column;gap:30px}.content{display:flex;flex-direction:column;gap:10px}.content__title{margin:0}.race{display:flex;flex-direction:column;gap:15px}.race-view{position:relative;display:flex;width:calc(100vw - 60px);border-bottom:#edeef1 2px dashed}.btns-and-car-name{display:flex;align-items:center}.engine-start-btn,.engine-stop-btn{margin-bottom:10px}.engine-stop-btn{padding:8px;margin-right:40px;font-size:20px}.car-name{padding-left:10px;color:#ff8450}.car-svg-container{height:33px;align-self:flex-end}.car{height:33px}.flag{font-size:40px;position:absolute;right:150px;top:7px;cursor:default}.pagination{align-self:center}.winner-sign{position:absolute;left:0;right:0;top:35%;font-size:60px;text-align:center;color:#fff;text-shadow:0px -1px 4px #fff,0px -2px 10px #ff0,0px -10px 20px #ff8000,0px -18px 40px red}@media(max-width: 800px){.flag{right:100px}}.winners{display:flex;flex-direction:column;min-height:682px;gap:30px}.winners-content{display:flex;flex-direction:column;gap:10px;align-items:center}.winners-table{border-collapse:collapse;text-align:center}.winners-table-th{border:1px solid #000;background:#a90fdb}.winners-table-th:nth-child(1){padding:0 10px}.winners-table-th:nth-child(2){padding:0 50px}.winners-table-th:nth-child(3){padding:0 80px}.winners-table-th:nth-child(4){position:relative}.winners-table-th:nth-child(5){position:relative}@media(max-width: 615px){.winners-table-th~.winners-table-th{padding:0 5px}.winners-table-th:nth-child(2){padding:0 35px}}.wins-sorter-btn,.time-sorter-btn{padding:5px 30px;background:none;cursor:pointer;border:none;color:#edeef1;font-weight:bold}.wins-sort-arrow,.time-sort-arrow{position:absolute;top:-3px;right:5px;font-size:25px}.winners-row{height:50px}.winners-row td{border-bottom:1px solid #000}.winners-row td:nth-child(3){color:#ff8450}.winners-pagination{display:flex;justify-content:center;margin-top:auto}@media(max-width: 615px){td .car{height:20px}}',""]);const h=l},372:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,'/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */\n\n/* Document\n   ========================================================================== */\n* {\n  box-sizing: border-box;\n}\n/**\n * 1. Correct the line height in all browsers.\n * 2. Prevent adjustments of font size after orientation changes in iOS.\n */\n\nhtml {\n  line-height: 1.15; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n}\n\n/* Sections\n   ========================================================================== */\n\n/**\n * Remove the margin in all browsers.\n */\n\nbody {\n  margin: 0;\n}\n\n/**\n * Render the `main` element consistently in IE.\n */\n\nmain {\n  display: block;\n}\n\n/**\n * Correct the font size and margin on `h1` elements within `section` and\n * `article` contexts in Chrome, Firefox, and Safari.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * 1. Add the correct box sizing in Firefox.\n * 2. Show the overflow in Edge and IE.\n */\n\nhr {\n  box-sizing: content-box; /* 1 */\n  height: 0; /* 1 */\n  overflow: visible; /* 2 */\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\npre {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * Remove the gray background on active links in IE 10.\n */\n\na {\n  background-color: transparent;\n  text-decoration: none;\n}\n\n/**\n * 1. Remove the bottom border in Chrome 57-\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n */\n\nabbr[title] {\n  border-bottom: none; /* 1 */\n  text-decoration: underline; /* 2 */\n}\n\n/**\n * Add the correct font weight in Chrome, Edge, and Safari.\n */\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\ncode,\nkbd,\nsamp {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/**\n * Add the correct font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` elements from affecting the line height in\n * all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Remove the border on images inside links in IE 10.\n */\n\nimg {\n  border-style: none;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * 1. Change the font styles in all browsers.\n * 2. Remove the margin in Firefox and Safari.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  line-height: 1.15; /* 1 */\n  margin: 0; /* 2 */\n}\n\n/**\n * Show the overflow in IE.\n * 1. Show the overflow in Edge.\n */\n\nbutton,\ninput { /* 1 */\n  overflow: visible;\n}\n\n/**\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\n * 1. Remove the inheritance of text transform in Firefox.\n */\n\nbutton,\nselect { /* 1 */\n  text-transform: none;\n}\n\n/**\n * Correct the inability to style clickable types in iOS and Safari.\n */\n\nbutton,\n[type="button"],\n[type="reset"],\n[type="submit"] {\n  -webkit-appearance: button;\n}\n\n/**\n * Remove the inner border and padding in Firefox.\n */\n\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\n\n/**\n * Restore the focus styles unset by the previous rule.\n */\n\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\n\n/**\n * Correct the padding in Firefox.\n */\n\nfieldset {\n  padding: 0.35em 0.75em 0.625em;\n}\n\n/**\n * 1. Correct the text wrapping in Edge and IE.\n * 2. Correct the color inheritance from `fieldset` elements in IE.\n * 3. Remove the padding so developers are not caught out when they zero out\n *    `fieldset` elements in all browsers.\n */\n\nlegend {\n  box-sizing: border-box; /* 1 */\n  color: inherit; /* 2 */\n  display: table; /* 1 */\n  max-width: 100%; /* 1 */\n  padding: 0; /* 3 */\n  white-space: normal; /* 1 */\n}\n\n/**\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\n */\n\nprogress {\n  vertical-align: baseline;\n}\n\n/**\n * Remove the default vertical scrollbar in IE 10+.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * 1. Add the correct box sizing in IE 10.\n * 2. Remove the padding in IE 10.\n */\n\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Correct the cursor style of increment and decrement buttons in Chrome.\n */\n\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Correct the odd appearance in Chrome and Safari.\n * 2. Correct the outline style in Safari.\n */\n\n[type="search"] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/**\n * Remove the inner padding in Chrome and Safari on macOS.\n */\n\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * 1. Correct the inability to style clickable types in iOS and Safari.\n * 2. Change font properties to `inherit` in Safari.\n */\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/* Interactive\n   ========================================================================== */\n\n/*\n * Add the correct display in Edge, IE 10+, and Firefox.\n */\n\ndetails {\n  display: block;\n}\n\n/*\n * Add the correct display in all browsers.\n */\n\nsummary {\n  display: list-item;\n}\n\n/* Misc\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 10+.\n */\n\ntemplate {\n  display: none;\n}\n\n/**\n * Add the correct display in IE 10.\n */\n\n[hidden] {\n  display: none;\n}\n',""]);const s=a},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(r)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(a[i]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);r&&a[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},379:(e,t,n)=>{var r,a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function i(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function o(e,t){for(var n={},r=[],a=0;a<e.length;a++){var o=e[a],c=t.base?o[0]+t.base:o[0],l=n[c]||0,d="".concat(c," ").concat(l);n[c]=l+1;var h=i(d),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(p)):s.push({identifier:d,updater:g(p,t),references:1}),r.push(d)}return r}function c(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var s=n.nc;s&&(r.nonce=s)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function h(e,t,n,r){var a=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,a);else{var s=document.createTextNode(a),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(s,i[t]):e.appendChild(s)}}function p(e,t,n){var r=n.css,a=n.media,s=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var m=null,u=0;function g(e,t){var n,r,a;if(t.singleton){var s=u++;n=m||(m=c(t)),r=h.bind(null,n,s,!1),a=h.bind(null,n,s,!0)}else n=c(t),r=p.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var a=i(n[r]);s[a].references--}for(var c=o(e,t),l=0;l<n.length;l++){var d=i(n[l]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}n=c}}}},213:(e,t,n)=>{e.exports=n.p+"img/rss-logo.svg"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.nc=void 0,(()=>{var e,t,r,a,s=n(379),i=n.n(s),o=n(137);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals;class c{constructor(){this.events={}}on(e,t){return(this.events[e]||(this.events[e]=[])).push(t),this}emit(e,t){(this.events[e]||[]).slice().forEach((e=>e(t)))}}!function(e){e.garage="https://teal-scorpion-tie.cyclic.app/garage/",e.engine="https://teal-scorpion-tie.cyclic.app/engine",e.winners="https://teal-scorpion-tie.cyclic.app/winners/"}(e||(e={})),function(e){e[e.Add=0]="Add",e[e.Update=1]="Update",e[e.Delete=2]="Delete",e[e.Next=3]="Next",e[e.Prev=4]="Prev",e[e.Never=5]="Never"}(t||(t={})),function(e){e.Started="started",e.Stopped="stopped",e.Drive="drive"}(r||(r={})),function(e){e.Hide="hide",e.Show="show"}(a||(a={}));const l=["Acura","Alfa Romeo","Alpine","Apollo","Apple","Aston Martin","Audi","Automobili Pininfarina","Bentley","BMW","Bollinger","Brilliance","Bugatti","Buick","BYD","Cadillac","Chana","Chery","Chevrolet","Chrysler","Citroen","Continental","CUPRA","Dacia","Daewoo","Daihatsu","Datsun","Detroit Electric","Dodge","DS Automobiles","FAW","Ferrari","Fiat","Fisker","Ford","Foxtron","Geely","Genesis","GMC","Great Wall","Haval","Honda","Hummer","Hyundai","Ineos","Infiniti","Iran Khodro","JAC","Jaguar","Jeep","JETOUR","KIA","Koenigsegg","Lada","Lamborghini","Lancia","Land Rover","Lexus","Lifan","Lincoln","Lordstown","Lotus","Lucid","LvChi","Lynk & Co","Maserati","Maybach","Mazda","MCLaren","Mercedes-Benz","MG","MINI","Mitsubishi","Nikola","NIO","Nissan","Opel","Pagani","Peugeot","Polestar","Porsche","Qoros","Range Rover","Ravon","Renault","Rimac","Rivian","Rolls-Royce","Saab","Saipa","SEAT","Skoda","smart","SsangYong","SSC North America","Stellantis","Subaru","Suzuki","Tata","Tesla","Torsus","Toyota","VinFast","Volkswagen","Volvo","Xpeng","Zotye"],d=["Durango","Ram","Challenger","Charger","Grand Caravan","X7","X5","X3","X6 M","X6","X1","X4","C3 Aircross","C5 Aircross","Duster","CR-V","Corolla","C4 Cactus","DS3 Crossback","C1","C3","Berlingo Multispace","DS4 Crossback","UX 250h","NX 300h","LC 500","RX 350/200t","Rapid","Largus","IS 200t","LS 500h","RX","ES 200/250/350","Hatchback","CX-5","Sedan","CX-30","CX-9","CX-3","MX-5 Roadster","Phantom","Camry","Polo","Cullinan","Ghost","Dawn","Duster","Arkana","Sandero","Logan","Trafic Fourgon","Logan MCV","Captur","Kadjar","RAV4","Rio","Creta","Solaris"];function h(){let e="#69696b";for(;"#69696b"===e;)e=`#${Math.floor(16777215*Math.random()).toString(16)}`;return e}function p(e=1){return`?_page=${e}&_limit=7`}function m(e,t){return`?id=${e}&status=${t}`}function u(e){const{winnersPage:t,sortOrder:n,sortBy:r}=e;return`?_page=${t}&_limit=10&_order=${n}&_sort=${r}`}function g(e){document.getElementsByClassName("js-race-btn")[0].disabled=e}function f(e){document.getElementsByClassName("js-reset-btn")[0].disabled=e}function w(e){document.getElementsByClassName("js-create-car-btn")[0].disabled=e,document.getElementsByClassName("js-update-car-btn")[0].disabled=e,document.getElementsByClassName("js-generate-btn")[0].disabled=e;const t=document.getElementsByClassName("js-remove-btn"),n=Array.from(t);for(let t=0;t<n.length;t+=1)n[t].disabled=e;document.getElementsByClassName("js-prev-btn")[0].disabled=e,document.getElementsByClassName("js-next-btn")[0].disabled=e}function b(){const e=document.getElementsByClassName("winners")[0];e.style.display="none"===e.style.display?"flex":"none",document.getElementsByClassName("js-winners-btn")[0].disabled="flex"===e.style.display;const t=document.getElementsByClassName("race-block")[0];t.style.display="none"===t.style.display?"flex":"none",document.getElementsByClassName("js-garage-btn")[0].disabled="flex"===t.style.display}function y(e){const t=document.getElementsByClassName("rules")[0];"hide"===e?t.classList.add("hide"):t.classList.remove("hide")}class C extends c{constructor(){super(),this.cars=[],this.allCars=[],this.carsTotalCount=0,this.page=1,this.winnersState={winnersCount:0,winners:[],winnersPage:1,sortOrder:"desc",sortBy:"wins"}}async getGarageCars(t){const n=await fetch(e.garage+t);this.cars=await n.json().catch((e=>console.error(e))),this.carsTotalCount=Number(n.headers.get("X-Total-Count"));const r=await fetch(e.garage);this.allCars=await r.json().catch((e=>console.error(e)))}async createCar(t){await fetch(e.garage,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})}async addCar(e){await this.createCar(e).catch((e=>console.error(e))),await this.getGarageCars(this.updateQueryParams(t.Add)),this.emit("carAdded")}async removeCar(n){await fetch(e.garage+n,{method:"DELETE"}),await this.getGarageCars(this.updateQueryParams(t.Delete)).catch((e=>console.error(e)));const r=await this.getWinner(n);0!==Object.keys(r).length&&await this.deleteWinner(r.id).catch((e=>console.error(e))),this.emit("carDeleted")}async selectCar(t){const n=await fetch(e.garage+t),r=await n.json();this.emit("carSelected",r.name)}async updateCar(n,r){await fetch(e.garage+r,{method:"PUT",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}),await this.getGarageCars(this.updateQueryParams(t.Never)).catch((e=>console.error(e))),this.emit("carUpdated")}async generateCars(e){await Promise.all(e.map((e=>this.createCar(e).catch((e=>console.error(e)))))),await this.getGarageCars(this.updateQueryParams(t.Never)).catch((e=>console.error(e))),this.emit("carsGenerated")}async startEngine(t,n){const r=await fetch(e.engine+t,{method:"PATCH"}),{distance:a,velocity:s}=await r.json(),i=Math.floor(a/s);this.emit("runCar",{time:i,id:n});const o=await this.drive(n);return o||this.emit("stopCar",n),{success:o,id:n,time:i}}async drive(t){const n=m(t,r.Drive),a=await fetch(e.engine+n,{method:"PATCH"}).catch((e=>console.error(e)));if(a)switch(a.status){case 200:return!0;case 400:this.emit("showMsg",'Wrong parameters: "id" should be any positive number, "status" should be "started", "stopped" or "drive"');break;case 404:this.emit("showMsg",'Engine parameters for car with such id was not found in the garage. Have you tried to set engine status to "started" before?');break;case 429:this.emit("showMsg","Drive already in progress. You can't run drive for the same car twice while it's not stopped.");break;case 500:this.emit("showMsg",`Car ${t} engine was broken`)}return!1}async stopEngine(t,n){await fetch(e.engine+t,{method:"PATCH"});try{this.emit("stopCar",n),this.emit("returnCarToStart",n)}catch(e){console.error(e)}}async raceAll(){return Promise.any(this.cars.map((async e=>{const t=m(e.id,r.Started),n=await this.startEngine(t,e.id);return n.success?n:Promise.reject()})))}async resetAll(){this.cars.forEach((e=>{const t=m(e.id,r.Stopped);this.stopEngine(t,e.id)}))}async goToNextPage(){const e=this.updateQueryParams(t.Next);await this.getGarageCars(e),this.emit("nextPage")}async goToPrevPage(){const e=this.updateQueryParams(t.Prev);await this.getGarageCars(e),this.emit("prevPage")}async createWinner(t){await fetch(e.winners,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).catch((e=>console.error(e)))}async updateWinner(t,n){await fetch(e.winners+t,{method:"PUT",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).catch((e=>console.error(e)))}async saveWinner(t){const n=await fetch(e.winners+t.id).catch((e=>console.error(e)));if(n){const e=await n.json();404===n.status?(this.emit("showMsg","New Winner In Table"),await this.createWinner({id:t.id,wins:1,time:t.time})):await this.updateWinner(e.id,{id:e.id,wins:e.wins+1,time:t.time<e.time?t.time:e.time})}}async deleteWinner(t){await fetch(e.winners+t,{method:"DELETE"}).catch((e=>console.error(e)))}async getWinner(t){const n=await fetch(e.winners+t).catch((e=>console.error(e)));if(n){if(200===n.status){const e=await n.json();return this.emit("showMsg","Winner was deleted from winners table"),e}404===n.status&&this.emit("showMsg","Deleted car has never won. Winners table remains untouched")}return{}}async getAllWinners(t){const n=await fetch(e.winners+t).catch((e=>console.error(e)));n&&(this.winnersState.winnersCount=Number(n.headers.get("X-Total-Count")),this.winnersState.winners=await n.json(),this.emit("showWinners",{sortBy:this.winnersState.sortBy,order:this.winnersState.sortOrder}))}updateQueryParams(e){const n=Math.ceil(this.carsTotalCount/7),r=this.cars.length;return e===t.Never||(e===t.Add&&7===r&&(this.page=n),e===t.Delete&&r<=1&&(this.page=this.page>1?this.page-1:1),e===t.Next&&this.page<n&&(this.page+=1),e===t.Prev&&this.page>1&&(this.page-=1)),p(this.page)}}class x{combineBaseHtmlParts(){const e=document.getElementsByTagName("body")[0];e.classList.add("body"),e.append(this.createHeader(),this.createRulesDiv(),this.createMain(),this.createFooter())}createHeader(){const e=document.createElement("header");e.classList.add("header");const t=document.createElement("h1");return t.classList.add("header__title"),t.textContent="Async-Race",e.append(t),e}createMain(){const e=document.createElement("main");return e.classList.add("main"),e}createRulesDiv(){const e=x.createDefaultDiv(["rules"]);return e.innerHTML="<h3>Some Rules:</h3><p>1. Please, stop the engine of each car or reset them all before race.</p><p>2. The winner is detected when a rear part of the car has crossed the flag icon.</p><p>3. If you try to use pagination while racing, the race will be reset.</p>",e}createFooter(){const e=document.createElement("footer");e.classList.add("footer");const t=document.createElement("a");t.classList.add("footer__github-link"),t.href="https://github.com/DDD-fx",t.title="GitHub",t.textContent="© DDD-fx";const n=document.createElement("p");n.textContent="2022";const r=document.createElement("a");return r.classList.add("footer__logo-link"),r.href="https://rs.school/js/",e.append(t,n,r),e}static createDefaultDiv(e,t=""){const n=document.createElement("div");return e.forEach((e=>n.classList.add(e))),t&&(n.textContent=t),n}static createDefaultInput(e,t="",n=""){const r=document.createElement("input");return r.classList.add(e,e.slice(3)),t&&(r.type=t),n&&(r.placeholder=n),r}static createDefaultBtn(e,t){const n=document.createElement("button");return n.classList.add(e,e.slice(3),"btn"),n.innerHTML=t,n}static setIDs(e,t){e.forEach((e=>e.setAttribute("id",`${e.classList[0]}-${t}`)))}static createCarSvg(e){return`<?xml version="1.0" encoding="iso-8859-1"?>\n    <svg version="1.1" class="car" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"\n    viewBox="-1 6 22 8" style="fill:${e}; stroke:black; stroke-width:0.3;" xml:space="preserve">\n    <g><path d="M20.07,10.102c0,0-0.719-1.593-5.363-1.53c0,0-4.626-4.644-13.986,0.582\n    c0,0,0.205,1.018-0.566,1.018c-0.159,0.765-0.322,1.769,0.203,2.294c1.146,0,1.257,0,1.266,0c-0.028-0.123-0.044-0.25-0.044-0.381\n    c0-0.951,0.771-1.722,1.722-1.722s1.722,0.771,1.722,1.722c0,0.131-0.016,0.258-0.044,0.381h0.268h8.357h1.119\n    c-0.027-0.123-0.043-0.25-0.043-0.381c0-0.951,0.771-1.722,1.721-1.722c1.297,0,2.037,1.318,1.906,2.092l1.762-0.182\n    C19.801,10.687,20.07,10.102,20.07,10.102z M6.936,8.835H2.829c0,0,1.703-0.798,4.107-1.261V8.835z M7.827,8.835V7.427\n    c3.442-0.498,6.143,1.408,6.143,1.408H7.827z"/>\n    <path style="fill:orange;" d="M16.402,10.742c-0.734,0-1.33,0.595-1.33,1.33c0,0.733,0.596,1.329,1.33,1.329\n    s1.514-0.596,1.514-1.329C17.916,11.336,17.137,10.742,16.402,10.742z M16.402,12.582c-0.283,0-0.512-0.229-0.512-0.511\n    s0.229-0.512,0.512-0.512c0.281,0,0.512,0.229,0.512,0.512C16.914,12.353,16.683,12.582,16.402,12.582z"/>\n    <path style="fill:lightgreen;" d="M3.268,10.742c-0.734,0-1.329,0.595-1.329,1.33c0,0.733,0.595,1.329,1.329,1.329\n    c0.735,0,1.33-0.596,1.33-1.329C4.597,11.336,4.003,10.742,3.268,10.742z M3.268,12.582c-0.282,0-0.512-0.229-0.512-0.511\n    s0.23-0.512,0.512-0.512s0.512,0.229,0.512,0.512C3.78,12.353,3.55,12.582,3.268,12.582z"/></g></svg>`}static createModalWrapper(){return x.createDefaultDiv(["js-error-wrapper","error-wrapper"])}static showMsgModal(e){const t=document.getElementsByClassName("js-error-wrapper")[0],n=x.createDefaultDiv(["js-error-msg","error-msg"]);n.style.display="block",n.textContent=String(e),t.prepend(n),setTimeout((()=>{n.style.display="none"}),7e3)}static createAddCarErrMsg(){const e=x.createDefaultDiv(["js-add-car-error","add-car-error"]);return e.style.display="none",e}static createUpdateCarErrMsg(){const e=x.createDefaultDiv(["js-update-car-error","add-update-error"]);return e.style.display="none",e}static showInputErrMsg(e){const n=document.getElementsByClassName("js-add-car-error")[0],r=document.getElementsByClassName("js-update-car-error")[0];e===t.Add&&(n.style.display="block",n.textContent="Please specify car name",setTimeout((()=>{n.style.display="none"}),3e3)),e===t.Update&&(r.style.display="block",r.textContent="Please select the car",setTimeout((()=>{r.style.display="none"}),3e3))}}class v extends c{constructor(e,t){super(),this.model=e,this.view=t}rebuildWinners(){const e=document.getElementsByClassName("winners")[0];e.innerHTML="",e.append(...this.createWinnersBlock(this.model.winnersState.winnersCount,this.model.winnersState.winnersPage),this.createPagination());const t=document.getElementsByClassName("winners-table")[0];let n=10*this.model.winnersState.winnersPage-9-1;this.model.winnersState.winners.forEach((e=>{n+=1;const r=this.model.allCars.find((t=>t.id===e.id));if(r){const a=r.name,s=(e.time/1e3).toFixed(2),i=x.createCarSvg(r.color),o=[n,i,a,e.wins,s];t.append(this.createTableContent(o))}})),this.checkActivePaginationBtns()}createWinnersBlock(e,t){const n=x.createDefaultDiv(["winners-content"]),r=document.createElement("h2");r.classList.add("content__title"),r.textContent=`Winners (${e})`;const a=x.createDefaultDiv(["content__page"]);return a.textContent=`Page № ${t} of ${Math.ceil(e/10)||1}`,n.append(r,a),[n,this.createTable()]}createTable(){const e=document.createElement("table");return e.classList.add("winners-table"),e.append(this.createTableHeader()),e}createTableHeader(){const e=document.createElement("tr");return["№","Car","Name","Wins","Best Time (sec)"].forEach((t=>{const n=document.createElement("th");if(n.classList.add("winners-table-th"),"Wins"===t){const e=this.createTableHeaderSorters("js-wins-sorter-btn",t),r=x.createDefaultDiv(["wins-sort-arrow"]);e.addEventListener("click",(()=>this.emit.call(this.view,"sortByWinsBtnClicked"))),n.append(e,r)}else if("Best Time (sec)"===t){const e=this.createTableHeaderSorters("js-time-sorter-btn",t),r=x.createDefaultDiv(["time-sort-arrow"]);e.addEventListener("click",(()=>this.emit.call(this.view,"sortByTimeBtnClicked"))),n.append(e,r)}else n.textContent=t;e.append(n)})),e}createTableContent(e){const t=document.createElement("tr");return t.classList.add("winners-row"),e.forEach((e=>{const n=document.createElement("td");n.innerHTML=`${e}`,t.append(n)})),t}createTableHeaderSorters(e,t){const n=document.createElement("button");return n.classList.add(e,e.slice(3)),n.textContent=t,n}createPagination(){const e=x.createDefaultDiv(["winners-pagination"]),t=x.createDefaultBtn("js-prev-winner-btn","prev".toUpperCase());t.addEventListener("click",(()=>this.emit.call(this.view,"prevWinnerPageClicked")));const n=x.createDefaultBtn("js-next-winner-btn","next".toUpperCase());return n.addEventListener("click",(()=>this.emit.call(this.view,"nextWinnerPageClicked"))),e.append(t,n),e}checkActivePaginationBtns(){const e=Math.ceil(this.model.winnersState.winnersCount/10),t=this.model.winnersState.winnersPage,n=document.getElementsByClassName("js-prev-winner-btn")[0];document.getElementsByClassName("js-next-winner-btn")[0].disabled=t>=e,n.disabled=1===t}showSortArrow(e){const{sortBy:t,order:n}=e,r=document.getElementsByClassName("wins-sort-arrow")[0],a=document.getElementsByClassName("time-sort-arrow")[0];"wins"===t&&(r.textContent="asc"===n?"↑":"↓",a.style.display="none"),"time"===t&&(a.textContent="asc"===n?"↑":"↓",r.style.display="none")}static createWinnerSign(){return x.createDefaultDiv(["js-winner-sign","winner-sign"])}static showWinnerSign(e){const t=document.getElementsByClassName("js-winner-sign")[0],n=document.getElementsByClassName(`js-car-name-${e.id}`)[0].textContent;t.style.display="block",t.textContent=`${n} has won with a result [ ${(e.time/1e3).toFixed(2)} sec ]`,setTimeout((()=>{t.style.display="none"}),7e3)}}class B extends c{constructor(e){super(),this.model=e,this.store={}}getDistanceBetweenElems(e,t){const n=e.getBoundingClientRect().left,r=t.getBoundingClientRect().right;return Math.floor(r-n)}startAnimation(e){const{time:t,id:n}=e,r=document.getElementById(`car-${n}`),a=document.getElementById(`js-flag-${n}`),s=this.getDistanceBetweenElems(r,a);!function(e,t){document.getElementById(`js-engine-stop-btn-${e}`).disabled=!1}(n),g(!0),this.store[n]=this.animation(r,s,t)}animation(e,t,n){let r=0;const a={id:0};return a.id=window.requestAnimationFrame((function s(i){r||(r=i);const o=i-r,c=Math.round(o*(t/n));e.style.transform=`translateX(${Math.min(c,t)}px)`,c<t&&(a.id=window.requestAnimationFrame(s))})),a}stopAnimation(e){window.cancelAnimationFrame(this.store[`${e}`].id)}returnCarToStart(e){const t=document.getElementById(`car-${e}`);t&&(t.style.transform="translateX(0px)",document.getElementById(`js-engine-start-btn-${e}`).disabled=!1,document.getElementById(`js-engine-stop-btn-${e}`).disabled=!0,function(){const e=document.getElementsByClassName("js-engine-stop-btn");return Array.from(e).find((e=>!e.disabled))}()||g(!1))}}class E extends c{constructor(e){super(),this.htmlBuilder=new x,this.winners=new v(e,this),this.animation=new B(e),this.model=e,e.on("carAdded",(()=>this.rebuildList())).on("carDeleted",(()=>this.rebuildList())).on("carSelected",(e=>this.updateInputOnCarSelection(e))).on("carUpdated",(()=>this.rebuildList())).on("carsGenerated",(()=>this.rebuildList())).on("nextPage",(()=>this.rebuildList())).on("prevPage",(()=>this.rebuildList())).on("runCar",(e=>this.animation.startAnimation(e))).on("stopCar",(e=>this.animation.stopAnimation(e))).on("returnCarToStart",(e=>this.animation.returnCarToStart(e))).on("showWinners",(()=>this.winners.rebuildWinners())).on("showWinners",(e=>this.winners.showSortArrow(e))).on("showMsg",(e=>x.showMsgModal(e)))}rebuildList(){const e=document.getElementsByClassName("js-choose-car-name")[0],t=document.getElementsByClassName("js-update-car-name")[0];e.value="",t.value="";const n=document.getElementsByClassName("content")[0];n.innerHTML="",n.append(...this.createContentBlock(this.model.carsTotalCount,this.model.page));const r=document.getElementsByClassName("race")[0];r.innerHTML="",this.model.cars.forEach((e=>r.append(...this.createRaceBlock({color:e.color,name:e.name,id:e.id})))),this.checkActivePaginationBtns(),g(!1),f(!0)}combineView(){this.htmlBuilder.combineBaseHtmlParts();const e=document.getElementsByClassName("main")[0],t=x.createDefaultDiv(["race-block"]),n=x.createDefaultDiv(["content"]),r=x.createDefaultDiv(["race"]),a=x.createDefaultDiv(["winners"]);t.append(this.createControlsWrapper(),n,r,this.createPagination()),e.append(this.createGarageWinnersBlock(),t,a,v.createWinnerSign(),x.createModalWrapper())}createControlsWrapper(){const e=x.createDefaultDiv(["controls-wrapper"]);return e.append(this.createCreateCarBlock(),this.createUpdateCarBlock(),this.createRaceAllResetBlock()),e}createGarageWinnersBlock(){const e=x.createDefaultDiv(["garage-winners"]);return e.append(this.createGarageBtn(),this.createWinnersBtn()),e}createGarageBtn(){const e=x.createDefaultBtn("js-garage-btn","to garage".toUpperCase());return e.disabled=!0,e.addEventListener("click",(()=>{b(),y(a.Show)})),e}createWinnersBtn(){const e=x.createDefaultBtn("js-winners-btn","to winners".toUpperCase());return e.addEventListener("click",(()=>{y(a.Hide),this.emit("winnersBtnClicked"),b()})),e}createCreateCarBlock(){const e=x.createDefaultDiv(["create-car"]),t=x.createDefaultInput("js-choose-car-name","text","Car Name"),n=x.createDefaultInput("js-choose-car-color","color"),r=x.createDefaultBtn("js-create-car-btn","create".toUpperCase());return r.addEventListener("click",(()=>this.emit("createBtnClicked"))),e.append(t,n,r,x.createAddCarErrMsg()),e}createUpdateCarBlock(){const e=x.createDefaultDiv(["update-car"]),t=x.createDefaultInput("js-update-car-name","text","Car Name"),n=x.createDefaultInput("js-update-car-color","color"),r=x.createDefaultBtn("js-update-car-btn","update".toUpperCase());return r.addEventListener("click",(()=>this.emit("updateBtnClicked"))),e.append(t,n,r,x.createUpdateCarErrMsg()),e}createRaceAllResetBlock(){const e=x.createDefaultDiv(["race-reset"]);return e.append(this.createRaceBtn(),this.createResetBtn(),this.createGenerateBtn()),e}createRaceBtn(){const e=x.createDefaultBtn("js-race-btn","race".toUpperCase());return e.addEventListener("click",(()=>{g(!0),f(!0),function(e){const t=Array.from(document.getElementsByClassName("js-engine-start-btn"));for(let e=0;e<t.length;e+=1)t[e].disabled=true}(),w(!0),this.emit("raceBtnClicked")})),e}createResetBtn(){const e=x.createDefaultBtn("js-reset-btn","reset".toUpperCase());return e.disabled=!0,e.addEventListener("click",(()=>{g(!1),f(!0),this.emit("resetBtnClicked")})),e}createGenerateBtn(){const e=x.createDefaultBtn("js-generate-btn","generate cars".toUpperCase());return e.addEventListener("click",(()=>this.emit("generateBtnClicked"))),e}createContentBlock(e,t){const n=document.createElement("h2");n.classList.add("content__title"),n.textContent=`Garage (${e})`;const r=x.createDefaultDiv(["content__page"]);return r.textContent=`Page № ${t} of ${Math.ceil(e/7)||1}`,[n,r]}createRaceBlock({color:e,name:t,id:n}){const r=x.createDefaultDiv(["btns-and-car-name"]),a=x.createDefaultBtn("js-select-btn","select".toUpperCase());a.addEventListener("click",(()=>this.emit("selectBtnClicked",n)));const s=x.createDefaultBtn("js-remove-btn","remove".toUpperCase());s.addEventListener("click",(()=>this.emit("removeBtnClicked",n)));const i=x.createDefaultDiv([`js-car-name-${n}`,"car-name"],t),o=x.createDefaultDiv(["race-view"]),c=x.createDefaultBtn("js-engine-start-btn","▶".toUpperCase());c.addEventListener("click",(()=>{!function(e,t){document.getElementById(`js-engine-start-btn-${e}`).disabled=!0}(n),this.emit("runBtnClicked",n)}));const l=x.createDefaultBtn("js-engine-stop-btn","■".toUpperCase());l.addEventListener("click",(()=>this.emit("stopBtnClicked",n))),l.disabled=!0;const d=x.createDefaultDiv(["js-car-svg-container","car-svg-container"]);d.id=`car-${n}`,d.innerHTML=x.createCarSvg(e);const h=x.createDefaultDiv(["js-flag","flag"],"🏁");return x.setIDs([c,l,h],n),r.append(a,s,i),o.append(c,l,d,h),[r,o]}createPagination(){const e=x.createDefaultDiv(["pagination"]),t=x.createDefaultBtn("js-prev-btn","prev".toUpperCase());t.addEventListener("click",(()=>{g(!1),f(!0),this.emit("prevPageClicked")}));const n=x.createDefaultBtn("js-next-btn","next".toUpperCase());return n.addEventListener("click",(()=>{g(!1),f(!0),this.emit("nextPageClicked")})),e.append(t,n),e}updateInputOnCarSelection(e){const t=document.getElementsByClassName("js-update-car-name")[0];"string"==typeof e&&(t.value=e)}checkActivePaginationBtns(){const e=Math.ceil(this.model.carsTotalCount/7),t=this.model.page,n=document.getElementsByClassName("js-next-btn")[0],r=document.getElementsByClassName("js-prev-btn")[0];n.disabled=t>=e,r.disabled=1===t}}class S{constructor(e,t){this.currentSelection="",this.model=e,this.view=t,t.on("createBtnClicked",(()=>this.addCar())).on("removeBtnClicked",(e=>this.removeCar(e))).on("selectBtnClicked",(e=>this.selectCar(e))).on("updateBtnClicked",(()=>this.updateCar())).on("generateBtnClicked",(()=>this.generateCars())).on("nextPageClicked",(()=>this.goToNextPage())).on("prevPageClicked",(()=>this.goToPrevPage())).on("runBtnClicked",(e=>this.startEngine(e))).on("stopBtnClicked",(e=>this.stopEngine(e))).on("raceBtnClicked",(()=>this.raceAll())).on("resetBtnClicked",(()=>this.resetAll())).on("winnersBtnClicked",(()=>this.getAllWinners())).on("sortByWinsBtnClicked",(()=>this.sortByWins())).on("sortByTimeBtnClicked",(()=>this.sortByTime())).on("nextWinnerPageClicked",(()=>this.goToNextWinnerPage())).on("prevWinnerPageClicked",(()=>this.goToPrevWinnerPage()))}addCar(){const e=document.getElementsByClassName("js-choose-car-name")[0].value;if(this.isEmpty(e,t.Add))return;const n=document.getElementsByClassName("js-choose-car-color")[0].value;this.model.addCar({name:e,color:n}).catch((e=>console.error(e)))}removeCar(e){this.model.removeCar(String(e)).catch((e=>console.error(e)))}selectCar(e){this.currentSelection=String(e),this.model.selectCar(this.currentSelection).catch((e=>console.error(e)))}updateCar(){const e=document.getElementsByClassName("js-update-car-name")[0].value;if(this.isEmpty(e,t.Update))return;const n=document.getElementsByClassName("js-update-car-color")[0].value;this.model.updateCar({name:e,color:n},this.currentSelection).catch((e=>console.error(e)))}generateCars(){const e=new Array(100).fill("").map((()=>({name:`${l[Math.floor(Math.random()*l.length)]} ${d[Math.floor(Math.random()*d.length)]}`,color:h()})));this.model.generateCars(e).catch((e=>console.error(e)))}startEngine(e){const t=m(String(e),r.Started);return this.model.startEngine(t,String(e)).catch((e=>console.error(e)))}stopEngine(e){const t=m(String(e),r.Stopped);this.model.stopEngine(t,String(e)).catch((e=>console.error(e)))}async raceAll(){try{const e=await this.model.raceAll();e&&(v.showWinnerSign({id:e.id,time:e.time}),await this.model.saveWinner({id:e.id,time:e.time}))}catch(e){console.error("All engines were broken")}finally{g(!0),f(!1),w(!1),this.view.checkActivePaginationBtns()}}resetAll(){this.model.resetAll().catch((e=>console.error(e)))}goToNextPage(){this.model.goToNextPage().catch((e=>console.error(e)))}goToPrevPage(){this.model.goToPrevPage().catch((e=>console.error(e)))}getAllWinners(){const e=u({winnersPage:this.model.winnersState.winnersPage,sortOrder:this.model.winnersState.sortOrder,sortBy:this.model.winnersState.sortBy});this.model.getAllWinners(e).catch((e=>console.error(e)))}sortByWins(){this.model.winnersState.sortOrder="desc"===this.model.winnersState.sortOrder?"asc":"desc",this.model.winnersState.sortBy="wins";const e=u({winnersPage:this.model.winnersState.winnersPage,sortOrder:this.model.winnersState.sortOrder,sortBy:this.model.winnersState.sortBy});this.model.getAllWinners(e).catch((e=>console.error(e)))}sortByTime(){this.model.winnersState.sortOrder="desc"===this.model.winnersState.sortOrder?"asc":"desc",this.model.winnersState.sortBy="time";const e=u({winnersPage:this.model.winnersState.winnersPage,sortOrder:this.model.winnersState.sortOrder,sortBy:this.model.winnersState.sortBy});this.model.getAllWinners(e).catch((e=>console.error(e)))}goToNextWinnerPage(){this.model.winnersState.winnersPage+=1;const e=u({winnersPage:this.model.winnersState.winnersPage,sortOrder:this.model.winnersState.sortOrder,sortBy:this.model.winnersState.sortBy});this.model.getAllWinners(e).catch((e=>console.error(e)))}goToPrevWinnerPage(){this.model.winnersState.winnersPage-=1;const e=u({winnersPage:this.model.winnersState.winnersPage,sortOrder:this.model.winnersState.sortOrder,sortBy:this.model.winnersState.sortBy});this.model.getAllWinners(e).catch((e=>console.error(e)))}isEmpty(e,n){return""===e&&(n===t.Add&&x.showInputErrMsg(t.Add),n===t.Update&&x.showInputErrMsg(t.Update),!0)}}window.addEventListener("load",(async()=>{const e=new C;await e.getGarageCars(p()).catch((e=>console.error(e)));const t=new E(e);t.combineView(),document.getElementsByClassName("winners")[0].style.display="none",t.rebuildList(),new S(e,t)}))})()})();